@startuml
' ==========================================================
' bioeng-tsn-app â€” Use Case Diagram (based on provided code)
' ==========================================================

left to right direction
skinparam shadowing false
skinparam packageStyle rectangle
skinparam actorStyle awesome
skinparam usecase {
  BorderColor #2E3440
  BackgroundColor #ECEFF4
}

actor "Web Frontend / API Client" as Client
actor "System Admin / DevOps" as Admin

actor "PostgreSQL Database\n(imperial_profiles)" as PG <<external>>
actor "DeepSeek API" as DeepSeek <<external>>

rectangle "bioeng-tsn-app\n(Spring Boot REST API)" as SYS {

  ' --------------------
  ' Public / client flows
  ' --------------------
  usecase "Access Home Page" as UC_HOME
  usecase "Search Courses" as UC_COURSE_SEARCH
  usecase "Filter by Course Name" as UC_COURSE_FILTER
  usecase "Paginate Course Results" as UC_COURSE_PAGE
  usecase "Load Course Details" as UC_COURSE_DETAIL
  usecase "Load Course Modules" as UC_COURSE_MODULES

  usecase "Search Users" as UC_USER_SEARCH
  usecase "Filter by Full Name" as UC_USER_FILTER
  usecase "View User Profile Details" as UC_USER_DETAIL
  usecase "Load User Addresses" as UC_USER_ADDR
  usecase "Load User Phone Numbers" as UC_USER_PHONE
  usecase "Paginate User Results" as UC_USER_PAGE

  usecase "Chat with AI Assistant" as UC_AI_CHAT
  usecase "Submit Message" as UC_AI_SUBMIT
  usecase "Call DeepSeek Completion API" as UC_AI_CALL
  usecase "Parse & Return AI Response" as UC_AI_PARSE

  ' --------------------
  ' Ops / debugging flows
  ' --------------------
  usecase "Ping Service" as UC_PING
  usecase "Check Service Health" as UC_HEALTH
  usecase "Check DB Connectivity" as UC_DB_CHECK
  usecase "List Available API Endpoints" as UC_API_LIST
  usecase "View Runtime Environment Variables" as UC_ENV
}

' ===============
' Actor relations
' ===============
Client --> UC_HOME
Client --> UC_COURSE_SEARCH
Client --> UC_USER_SEARCH
Client --> UC_AI_CHAT

Admin --> UC_PING
Admin --> UC_HEALTH
Admin --> UC_ENV

PG --> UC_COURSE_SEARCH
PG --> UC_USER_SEARCH
PG --> UC_DB_CHECK

DeepSeek --> UC_AI_CALL

' =====================
' Includes / extensions
' =====================
UC_COURSE_SEARCH ..> UC_COURSE_FILTER : <<include>>
UC_COURSE_SEARCH ..> UC_COURSE_PAGE   : <<include>>
UC_COURSE_SEARCH ..> UC_COURSE_DETAIL : <<include>>
UC_COURSE_DETAIL ..> UC_COURSE_MODULES: <<include>>

UC_USER_SEARCH ..> UC_USER_FILTER     : <<include>>
UC_USER_SEARCH ..> UC_USER_PAGE       : <<include>>
UC_USER_DETAIL ..> UC_USER_ADDR       : <<include>>
UC_USER_DETAIL ..> UC_USER_PHONE      : <<include>>
UC_USER_DETAIL ..> UC_USER_PAGE       : <<include>>
UC_USER_DETAIL ..> UC_USER_SEARCH     : <<extend>>

UC_HEALTH ..> UC_DB_CHECK             : <<include>>
UC_HEALTH ..> UC_API_LIST             : <<include>>

UC_AI_CHAT ..> UC_AI_SUBMIT           : <<include>>
UC_AI_CHAT ..> UC_AI_CALL             : <<include>>
UC_AI_CHAT ..> UC_AI_PARSE            : <<include>>

' =====================
' Endpoint notes (from code)
' =====================
note right of UC_HOME
  HomeController
  - GET /  ("" mapping)
  - serves static index.html (welcome page)
end note

note right of UC_COURSE_SEARCH
  CoursesController
  - GET /courses/search
    params: courseName (optional), page, size
  - returns paged CourseDetailDTO
    (course info + modules)
end note

note right of UC_COURSE_MODULES
  CoursesService
  - For each course record:
    query CourseModules by course_id
  - assembles ModuleDTO list into CourseDetailDTO
end note

note right of UC_USER_SEARCH
  UsersController
  - GET /users/search
    params: fullName (optional)
  - returns List<Users>
end note

note right of UC_USER_DETAIL
  UsersController
  - GET /users/search/details
    params: fullName (optional), page, size
  - returns paged UserDetailDTO
    (user + addresses + phoneNumbers)
end note

note right of UC_AI_CHAT
  AiController
  - POST /ai/chat
    body: { "message": "..." }
  - calls DeepSeekService -> DeepSeek API
  - returns: { "response": "..." }
end note

note right of UC_HEALTH
  HealthController
  - GET /health
  - GET /healthz
  - GET /heartbeat
  - GET /ping
  Health response includes:
  - status = UP/DOWN
  - dbStatus (+ error if failed)
  - endpoints list
end note

note right of UC_ENV
  EnvDebugConfig (DEBUG ONLY)
  - GET /env
  - returns selected env vars
    (may contain secrets)
end note

@enduml
